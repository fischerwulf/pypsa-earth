.. SPDX-FileCopyrightText:  PyPSA-Earth and PyPSA-Eur Authors
..
.. SPDX-License-Identifier: CC-BY-4.0

.. _introduction:

##########################################
Introduction
##########################################

PyPSA-Earth is an open-source energy system optimization model that enables the modeling of any country's energy system worldwide. It provides high spatial and temporal resolution for both operational and capacity expansion studies across multiple energy sectors including electricity, heating, transport, industry, and hydrogen.

The following video explains the logic of PyPSA-Eur, which shares similar principles with PyPSA-Earth:

.. raw:: html

    <iframe width="832" height="468" src="https://www.youtube.com/embed/ty47YU1_eeQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

For more details on PyPSA-Earth, read the milestone paper below.
For citations, please use the following BibTeX: ::

  @misc{PyPSAEarth,
  author = {Parzen, Maximilian and Abdel-Khalek, Hazem and Fedorova, Ekaterina and Mahmood, Matin and Frysztacki, Martha Maria and Hampp, Johannes and Franken, Lukas and Schumm, Leon and Neumann, Fabian and Poli, Davide and Kiprakis, Aristides and Fioriti, Davide},
  title = {PyPSA-Earth. A new global open energy system optimization model demonstrated in Africa},
  publisher = {Applied Energy},
  year = {2023},
  url = {https://www.sciencedirect.com/science/article/pii/S030626192300460},
  doi = {https://doi.org/10.1016/j.apenergy.2023.121096},
  }


Workflow
========

The model generation is controlled by the workflow management system `Snakemake <https://snakemake.bitbucket.io/>`_. This system orchestrates the execution of Python scripts in the correct order based on their dependencies.

**How it works:**

The ``Snakefile`` defines rules for each Python script in the ``scripts`` directory. Each rule specifies:
- Which input files the script requires
- Which output files the script produces
- The dependencies between different scripts

The ``snakemake`` tool automatically:
- Runs scripts in the correct order based on dependencies
- Tracks which parts of the workflow need to be regenerated when files are modified
- Ensures reproducible execution

**Example:**

By executing the following Snakemake command:

.. code:: bash

    .../pypsa-earth % snakemake -j 1 networks/elec_s_128.nc

the following workflow is automatically executed.

.. image:: img/workflow_introduction.png
    :align: center

The **blocks** represent individual rules (processing steps) required to create the file ``networks/elec_s_128.nc``.
Each rule executes scripts (primarily Python) to transform input data into output data.
The **arrows** show the data flow: outputs from one rule become inputs for subsequent rules.

.. note::
    For reproducibility purposes, the image can be obtained through
    ``snakemake --dag networks/elec_s_128.nc | dot -Tpng -o workflow.png``
    using `Graphviz <https://graphviz.org/>`_


================
Folder Structure
================

The PyPSA-Earth package is organized into the following directories:

**Input and Configuration:**
- ``data``: Contains input data that is not generated by the workflow (e.g., geographical data, cost assumptions).
- ``envs``: Contains conda environment files required to run the workflow.

**Processing:**
- ``scripts``: Contains all Python scripts that perform the data processing and model building.

**Intermediate Results:**
- ``resources``: Stores intermediate results that can be reused by subsequent processing steps.
- ``networks``: Stores intermediate, unsolved PyPSA network models.

**Final Results:**
- ``results``: Contains the final solved PyPSA networks, summary files, and visualization plots.

**Workflow Management:**
- ``benchmarks``: Stores performance benchmarks for each processing step.
- ``logs``: Contains detailed log files including solver output, console messages, and memory usage.


=======
License
=======

PyPSA-Earth is released under multiple open-source licenses:

* **Source Code**: Licensed as free software under `AGPL-3.0 License <https://github.com/pypsa-meets-earth/pypsa-earth/blob/main/LICENSES>`_
* **Documentation**: Licensed under `CC-BY-4.0 <https://creativecommons.org/licenses/by/4.0/>`_
* **Configuration Files**: Mostly licensed under `CC0-1.0 <https://creativecommons.org/publicdomain/zero/1.0/>`_
* **Data Files**: Licensed under various licenses as specified below

Individual files contain license information in their headers or in the `dep5 <.reuse/dep5>`_ file.

**Data Licenses:**

The following table shows the licenses for external data used in PyPSA-Earth:

.. csv-table::
   :header-rows: 1
   :file: configtables/licenses.csv


**License Abbreviations:**

* **BY**: Attribution Required - You must give appropriate credit to the original source
* **NC**: Non-Commercial Use Only - Usage restricted to non-commercial purposes
* **SA**: Share Alike - Derivative works must be shared under the same license
